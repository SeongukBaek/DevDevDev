**TOC**
- [태그 달린 클래스의 문제점.](#태그-달린-클래스의-문제점)
- [위 문제를 해결하는 방법: 서브타이핑(계층 구조 활용)](#위-문제를-해결하는-방법-서브타이핑계층-구조-활용)

# 태그 달린 클래스의 문제점.
두 가지 이상의 의미를 표현할 수 있으며, 그 중 현재 표현하는 의미를 태그 값으로 알려주는 클래스를 본 적이 있을 것이다. 이는 아래와 같은 단점 투성이다.
- 열거 타입 선언, 태그 필드, switch문 등 쓸데없는 코드가 많다.
- 또한 여러 구현이 한 클래스에 혼합돼 있어 가독성도 나쁘다.
- 다른 의미를 위한 코드가 항상 붙어 있어 메모리도 많이 사용한다.
- 필드들을 final로 선언하려면 해당 의미에 쓰이지 않는 필드들까지 생성자에서 초기화해야 한다.
  - 쓰지 않는 필드를 초기화하는 불필요한 코드가 늘어난다.
  - 생성자에서 태그 필드를 설정하고 해당 의미에 쓰이는 데이터 필드들을 초기화하는 데 컴파일러가 도와줄 수 있는 건 별로 없다.
      - 따라서 엉뚱한 필드를 초기화해도 런타임에서야 문제가 드러난다.
- 인스턴스의 타입만으로는 현재 나타내는 의미를 알 길이 없다.

> **태그 달린 클래스는 장황하고, 오류를 내기 쉽고, 비효율적이다.**

# 위 문제를 해결하는 방법: 서브타이핑(계층 구조 활용)
자바와 같은 객체 지향 언어는 **타입 하나로 다양한 의미의 객체를 표현하는 훨씬 나은 수단을 제공**한다.
- 클래스의 계층구조를 활용하는 **서브타이핑**이다.
- 먼저 계층 구조의 **루트가 될 추상 클래스를 정의**하고, 태그 값에 따라 동작이 달라지는 메소드들을 루트 클래스의 추상 메소드로 선언한다.
  - 태그 값에 상관없이 동작이 일정한 메소드들을 루트 클래스에 일반 메소드로 추가한다.
  - 모든 하위 클래스에서 공통으로 사용하는 데이터 필드들도 전부 루트 클래스로 올린다.
- **루트 클래스를 확장한 구체 클래스를 의미별로 하나씩 정의**한다.
  - 책의 예에서는 도형별 클래스를 만들고 각 도형에 필요한 데이터 필드를 넣는다.
  - 그리고 루트 클래스가 정의한 추상 메소드를 각자의 의미에 맞게 구현한다.

`추상 클래스 Figure` -> `Circle` , `Rectangle` 와 같은 클래스 계층구조로 변경하여, 태그 달린 클래스의 단점을 모두 없앤다.
- 관련 없던 데이터 필드 제거
- 각 클래스의 생성자가 모든 필드를 초기화
- 모든 추상 메소드의 구현 완료 여부를 컴파일러가 확인

이제 루트 클래스를 건드리지 않고 계층구조를 확장하고 사용할 수 있게 되었다.

또한 타입 사이의 자연스러운 계층 관계를 반영할 수 있어 유연성과 컴파일타임 타입 검사 능력을 높여준다.

❓ **왜 컴파일 타임 타입 검사 능력을 높여주는가?**
- 태그가 없고, 객체 간 계층 관계가 명확히 보이기 때문에 복잡하게 확인할 필요가 없어져서일까?