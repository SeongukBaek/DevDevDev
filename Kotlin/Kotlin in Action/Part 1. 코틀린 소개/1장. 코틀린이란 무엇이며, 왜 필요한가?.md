**다룰 내용**
- 코틀린 기본 기능 데모
- 코틀린 언어의 주요 특성
- 코틀린을 활용한 안드로이드와 서버 개발
- 코틀린이 다른 언어보다 더 나은 점
- 코틀린으로 코드를 작성하고 실행하는 방법

코틀린: 자바 플랫폼에서 돌아가는 새로운 프로그래밍 언어.
- 언어의 목표가 자바 코드와의 상호운용성에 맞춰져 있다.

**TOC**
- [코틀린 맛보기](#코틀린-맛보기)
- [코틀린의 주요 특성](#코틀린의-주요-특성)
  - [대상 플랫폼: 자바가 실행되는 모든 곳](#대상-플랫폼-자바가-실행되는-모든-곳)
  - [정적 타입 지정 언어](#정적-타입-지정-언어)
  - [함수형 프로그래밍과 객체지향 프로그래밍](#함수형-프로그래밍과-객체지향-프로그래밍)
- [코틀린 응용](#코틀린-응용)
  - [코틀린 서버 프로그래밍](#코틀린-서버-프로그래밍)
    - [코틀린 사용 시의 성능 (Java와 비교했을 때)](#코틀린-사용-시의-성능-java와-비교했을-때)
- [코틀린의 철학](#코틀린의-철학)
- [코틀린 도구 사용](#코틀린-도구-사용)
  - [코틀린 코드 컴파일](#코틀린-코드-컴파일)

---
# 코틀린 맛보기
```kotlin
data class Person(val name: String, val age: Int? = null)

fun main() {
    var persons = listOf(Person("코틀린"), Person("자바", age = 29), Person("파이썬", 31))
    
    val oldest = persons.maxBy { it.age ?: 0 }
    
    println("나이가 가장 많은 사람 : $oldest")
}
```
- [data class](https://kotlinlang.org/docs/data-classes.html) : 데이터를 저장하는 용도로 사용되는 클래스로, 주 생성자에 모든 프로퍼티가 명시되어야 한다.
  - `age` 는 `null` 을 할당할 수 있도록 `?` 를 사용했고, 기본 값으로 `null` 을 할당한다.
  - 해당 클래스의 인스턴스를 생성할 때는 프로퍼티명을 명시해도 되고, 순서에 맞게 값을 할당해도 된다.
- `maxBy` : 최댓값을 찾는 함수
  - 람다 식을 전달받는데, 이는 1개의 파라미터를 받는다.
    - `it` 키워드를 통해 인자에 접근할 수 있다.
- 엘비스 연산자(`?:`) : 해당 값이 `null` 인 경우, `:` 뒤의 값을 반환

# 코틀린의 주요 특성
먼저 코틀린을 통해 만들 수 있는 애플리케이션 종류를 본다.

## 대상 플랫폼: 자바가 실행되는 모든 곳
코틀린의 주목적은 자바와의 상호운용성이다. 즉 자바를 대체할 수 있는 더 간결하고 생산적이며, 안전한 언어가 되는 것이다. 코틀린이 활용될 수 있는 일반적인 영역이다.
- 서버상의 코드 (특히 백엔드)
- 안드로이드 디바이스에서 실행되는 모바일 애플리케이션

> 추가적으로, 다음의 환경에서도 잘 동작한다.
> - 인텔의 멀티 OS 엔진(자바 기반) -> iOS 디바이스
> - 토네이도FX, 자바FX -> 데스크탑 애플리케이션
> 또한, 자바스크립트로도 코틀린을 컴파일할 수 있다.
> - 이를 통해, 브라우저나 노드에서 코틀린 코드를 실행할 수 있다.

> 다음은 프로그래밍 언어로서 코틀린이 갖는 몇 가지 핵심 특성이다.

## 정적 타입 지정 언어
자바와 마찬가지로, 코틀린 또한 정적 타입 지정 언어이다.

이는 컴파일 시점에 타입을 알 수 있고, 프로그램 안에서 객체의 필드나 메소드를 사용할 때마다 컴파일러가 이에 대한 검증을 수행해줄 수 있다는 의미이다.

> **동적 타입 지정 언어와의 차이**
> - ex. Groovy, JRuby
> - 메소드나 필드 접근에 대한 검증이 실행 시점에 이뤄진다.
> - 코드가 짧아지고, 데이터 구조를 유연하게 생성할 수 있다.
> - 따라서 휴먼 에러를 컴파일 시점에 잡아낼 수 없다는 단점이 있다.

하지만 자바와 코틀린의 차이는 여기서 나타난다.
- **코틀린은 개발자가 타입을 직접 지정해줄 필요가 없다!**
- 왜냐면, **코틀린 컴파일러가 문맥으로부터 타입을 추론**해주기 때문이다!

```kotlin
var x = 1
```

- 이렇게 컴파일러가 문맥을 통해 타입을 결정하는 것을 **타입 추론**이라 한다.

**정적 타입 지정의 장점**
- 성능 : 실행 시점에 어떤 메소드를 호출할 지 알아내는 과정이 필요없어서 메소드 호출이 더 빠르다.
- 신뢰성 : 컴파일러의 검증으로 인해 실행 시 프로그램이 오류로 인해 중단될 가능성이 적다.
- 유지 보수성 : 타입을 알 수 있어, 처음 보는 코드 다루기도 쉽다.
- 도구 지원 : 리팩토링도 안전하게 할 수 있고, 도구 또한 더 정확한 코드 완성 기능을 제공할 수 있으며, IDE의 다른 지원 기능도 더 잘 만들 수 있다.

코틀린은 자바와 비슷하게 작동하는 개념들이 많다. 하지만 몇 가지 새로운 점들도 있는데, 그 중 가장 중요한 특성은 **널이 될 수 있는 타입(nullable type)을 지원한다**는 점이다.
- 이를 통해, 얻을 수 있는 이점은 **컴파일 시점에 NPE의 발생 여부를 검사할 수 있다**는 점이다.

또 다른 특성 중 하나로는 **함수 타입(function type)에 대한 지원**이다.
- 이를 알기 위해서는 함수형 프로그래밍에 대해, 그리고 코틀린은 이를 어떻게 지원하는지에 대해 알아야겠다.

## 함수형 프로그래밍과 객체지향 프로그래밍
**함수형 프로그래밍의 핵심 개념**
- 일급 시민(first-class)인 함수 : 자바스크립트와 유사하게, 함수를 일반 값처럼 다룰 수 있다는 특징이다.
  - 함수를 변수에 저장하거나, 인자로 다른 함수에 전달할 수 있고, 함수 내에서 새로운 함수를 만들어 반환할 수 있다.
- 불변성(immutability) : 만들어지고 나면 내부 상태가 절대로 바뀌지 않는 불변 객체를 사용할 수 있다.
- 부수 효과(side effect) 없음 : 입력이 같으면 항상 같은 출력을 내놓고, 다른 객체의 상태를 변경하지 않으며, 함수 외부나 다른 바깥 환경과 상호작용하지 않는 순수 함수를 사용할 수 있다.

그렇다면 이러한 **함수형 프로그래밍의 이점**은 무엇이 있을까?

**간결성**
- 명령형 코드에 비해 더 간결하며 우아하다.
- 함수를 값처럼 활용 -> 더 강력한 추상화 -> 코드 중복 방지

코드를 작성하면서, 공통부분을 함수로 뽑아내고, 서로 다른 세부 사항을 인자로 전달하는 경우가 있을 수 있다.
- 이때 이 인자는 그 자체가 함수가 되는데, 람다 식(무명 함수)를 사용하면 이러한 함수를 더 간결하게 표현할 수 있다.

```kotlin
fun findKotlin() = findPerson { it.name == "Kotlin" }
fun findJava() = findPerson { it.name == "Java" }
```

**스레드 안전성**
- 멀티 스레드 환경에서는 동기화가 가장 중요하다. 동기화 없이 같은 데이터를 여러 스레드가 변경하는 경우, 여러 문제가 발생할 수 있다.
- 코틀린에서는 앞서 나온 불변성과 순수 함수를 데이터 구조에 적용해, 복잡한 동기화 적용 없이 안전성을 보장할 수 있다.

**테스트 용이성**
- 코틀린에서의 부수 효과 없음이라는 특성으로 인해, 테스트에 필요한 환경을 구성하는 준비 코드가 필요하지 않아 테스트의 용이성을 가진다.

함수형 프로그래밍은 언어에 국한되지 않는 개념이다. 애초에 프로그래밍 방식의 차이임으로 모든 언어에서 사용할 수 있지만, 그와 달리 모든 언어가 이를 지원해주는 것은 아니다.
- 코틀린은 함수형 프로그래밍을 위한 많은 지원을 제공하지만, 그렇다고 해서 함수형 프로그래밍을 강제하지도 않는다. 따라서 적절히 패러다임을 적용하는 것이 중요하다.

# 코틀린 응용
## 코틀린 서버 프로그래밍
서버 프로그래밍은 광범위한 개념이다.
- 브라우저에 HTML을 반환해주는 웹 애플리케이션
- 모바일 애플리케이션에게 HTTP를 통해 JSON API를 제공하는 백엔드 애플리케이션
- RPC 프로토콜을 통해 서로 통신하는 마이크로서비스

이미 시장은 이러한 요구사항을 만족하는 자바로 짜여진 라이브러리나 프레임워크로 채워져있고, 이러한 시장에서 코틀린은 새로운 컴포넌트를 작성하거나, 기존 서비스 코드를 코틀린으로 이색해야 하는 경우에 잘 들어맞는다.
- **자바와의 상호 운용성 덕분.**
- HTML 생성 라이브러리, 영속성 프레임워크 등에서 코틀린의 이러한 특성을 잘 활용할 수 있다.

> 코틀린은 디폴트로 자바 8과 호환되고, 자바 9 ~ 17 버전을 지원할 수 있다. (현재 코틀린 1.9.20에서는 21 버전도 지원 가능)

### 코틀린 사용 시의 성능 (Java와 비교했을 때)
코틀린 컴파일러가 생성한 바이트코드는 일반적인 자바 코드와 똑같이 효율적으로 실행된다.
- 코틀린의 런타임 시스템은 상당히 작아서, 컴파일 결과물의 크기도 자바의 비해 많이 크지 않다.
- 또한 대부분의 코틀린 표준 라이브러리 함수는 인자로 받은 람다 함수를 인라이닝해서, 새로운 객체가 증가하지 않기에 GC로 인한 잦은 프로그램 중지도 없다.

# 코틀린의 철학
코틀린이 
- 자바와의 상호운용성에 초점을 맞춘,
- 실용적이고
- 간결하며
- 안전한

언어이다.

# 코틀린 도구 사용
코틀린 또한 컴파일 언어이므로, 컴파일이 먼저 이뤄져야 한다.

## 코틀린 코드 컴파일
코틀린 소스코드는 `.kt` 확장자를 사용한다.
- 코틀린 컴파일러는 해당 파일을 읽어 `.class` 를 생성한다.
- 이는 `kotlinc` 명령어를 통해 수행 가능하고, 이후 만들어진 바이트코드에 대해서는 `java -jar` 명령어로 실행 가능하다.

이렇게 컴파일된 코틀린 코드는 **코틀린 런타임 라이브러리**에 의존한다.
- 이는 코틀린 자체 표준 라이브러리 클래스 + 코틀린에서 확장한 자바 API 기능을 포함하고 있다.
- 따라서 코틀린 애플리케이션을 배포한다면, 해당 라이브러리도 함께 배포해야 한다.
- 그리고 코틀린에서는 자바에서 사용하는 maven, gradle과 같은 빌드 시스템을 그대로 사용할 수 있을 뿐더러, 이들은 코틀린 런타임 라이브러리도 패키징에 자동으로 포함해준다.